<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="favicon.ico" />
  <title>Arquitectura modular y prefabricada | Neomodulus</title>
  <meta name="keywords" content="casas prefabricadas, módulos, arquitectura modular, sostenibilidad, eficiencia energética" />
  <link rel="stylesheet" href="css/header.css" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="css/footer.css" />
</head>
<body>
  <header>
    <nav aria-label="Principal">
      <div class="logo">
        <img src="img/header img/logo.png" alt="Neomodulus logo" height="60" />
      </div>
      <ul id="primary-menu" class="menu" role="menubar">
        <li role="none"><a role="menuitem" href="index.html">Inicio</a></li>
        <li role="none" data-has-submenu>
          <a role="menuitem" aria-haspopup="true" aria-expanded="false" href="#!" tabindex="0">Modelos</a>
          <ul id="submenu-modelos" class="submenu submenu--grid" aria-label="Submenú de modelos" role="menu">
            <li class="grid" role="none">
              <div class="card" role="none">
                <a role="menuitem" href="#casas">
                  <img src="img/header img/submenu img/casa prefabricada.png" alt="Casas: viviendas completas" />
                  <div class="meta">
                    <div class="title">Casas Prefabricadas</div>
                    <div class="caption">Viviendas completas prefabricadas</div>
                  </div>
                </a>
              </div>
              <div class="card" role="none">
                <a role="menuitem" href="#apple-home">
                  <img src="img/header img/submenu img/apple house.png" alt="Apple Home 27 m²" />
                  <div class="meta">
                    <div class="title">Apple House</div>
                    <div class="caption">Acabados de alta calidad</div>
                  </div>
                </a>
              </div>
              <div class="card" role="none">
                <a role="menuitem" href="#space-home">
                  <img src="img/header img/submenu img/space house.jpg" alt="Space Home" />
                  <div class="meta">
                    <div class="title">Space House</div>
                    <div class="caption">Diseño minimal y eficiente</div>
                  </div>
                </a>
              </div>
              <div class="card" role="none">
                <a role="menuitem" href="#modulos">
                  <img src="img/header img/submenu img/estructuras modulares.png" alt="Módulos" />
                  <div class="meta">
                    <div class="title">Estructuras Modulares</div>
                    <div class="caption">Sistemas modulares</div>
                  </div>
                </a>
              </div>
            </li>
          </ul>
        </li>
        <li role="none"><a role="menuitem" href="#nosotros">Sobre Nosotros</a></li>
        <li role="none" data-has-submenu>
          <a role="menuitem" aria-haspopup="true" aria-expanded="false" href="#!" tabindex="0">Contacto</a>
          <ul id="submenu-contacto" class="submenu" aria-label="Submenú de contacto" role="menu">
            <li role="none"><a role="menuitem" href="component/contacto.html">Email</a></li>
            <li role="none"><a role="menuitem" href="https://wa.me/" target="_blank" rel="noopener">WhatsApp</a></li>
          </ul>
        </li>
        <li role="none"><a role="menuitem" href="#faq">FAQ</a></li>
      </ul>

      <div class="right-controls">
        <button class="menu-toggle" type="button" aria-label="Abrir menú" aria-controls="primary-menu" aria-expanded="false">
          <span aria-hidden="true" class="menu-toggle__bars"><span></span><span></span><span></span></span>
        </button>

        <!-- MENÚ DE IDIOMA -->
        <div class="lang-switcher" role="group" aria-label="Selector de idioma">
          <input type="checkbox" id="lang-toggle" class="lang-toggle" aria-hidden="true" />
          <label for="lang-toggle" class="lang-trigger" aria-haspopup="menu" aria-controls="lang-menu" aria-expanded="false">
            <span class="globe-wrapper" role="img" aria-label="Seleccionar idioma">
              <img src="img/header img/trad/trad icono.png" alt="Globo terráqueo" />
            </span>
          </label>
          <nav id="lang-menu" class="lang-menu" role="menu" aria-labelledby="lang-toggle">
            <div class="lang-title">Idioma</div>
            <ul class="lang-list">
              <li class="lang-item"><a href="?lang=es">Español</a></li>
              <li class="lang-item"><a href="?lang=en">English</a></li>
              <li class="lang-item"><a href="?lang=fr">Français</a></li>
              <li class="lang-item"><a href="?lang=de">Deutsch</a></li>
              <li class="lang-item"><a href="?lang=it">Italiano</a></li>
            </ul>
          </nav>
        </div>
      </div>
      <div class="menu-backdrop" hidden></div>
    </nav>
  </header>

  <footer class="footer" id="contacto">
    <div class="footer-content">
      <div class="footer-section">
        <h4>Neomodulus</h4>
        <p>Arquitectura modular: viviendas modernas, eficientes y sostenibles.</p>
      </div>
      <div class="footer-section">
        <h4>Contacto</h4>
        <p>Tel: +34 123 456 789<br />
          <a href="contacto.html">info@neomodulus.com</a><br />
          <a href="mailto:marcroca@neomodulus.com">marcroca@neomodulus.com</a>
        </p>
      </div>
      <div class="footer-section">
        <h4>Síguenos</h4>
        <div class="footer-social">
          <a href="#" aria-label="Instagram"><img src="img/footer img/ig icono.png" alt="Instagram" class="footer-icon" /></a>
          <a href="#" aria-label="Wallapop"><img src="img/footer img/whatsapp icono.png" alt="Wallapop" class="footer-icon" /></a>
          <a href="https://wa.me/34123456789" aria-label="WhatsApp" target="_blank" rel="noopener"><img src="img/footer img/whatsapp icono.png" alt="WhatsApp" class="footer-icon" /></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      &copy; <span id="year"></span> Neomodulus. Todos los derechos reservados.
    </div>
  </footer>

  <!-- ===== JS ===== -->
  <script>
  (function () {
    function onKey(e){
      if(e.key === 'Escape' && location.hash){
        history.pushState("", document.title, window.location.pathname + window.location.search);
      }
    }
    document.addEventListener('keydown', onKey);
    window.addEventListener('hashchange', function(e){ e.preventDefault?.(); });
  })();

  (function(){
    const OPEN_DELAY = 80;
    const CLOSE_DELAY = 220;

    const items = document.querySelectorAll('.menu > li[data-has-submenu]');
    const header = document.querySelector('header');

    items.forEach(li => {
      const trigger = li.querySelector(':scope > a[aria-haspopup="true"]');
      const panel   = li.querySelector(':scope > .submenu');
      if (!trigger || !panel) return;

      let openTimer = null;
      let closeTimer = null;

      const open = () => {
        clearTimeout(closeTimer);
        if (li.classList.contains('is-open')) return;
        openTimer = setTimeout(() => {
          li.classList.add('is-open');
          trigger.setAttribute('aria-expanded','true');
          trigger.classList.add('submenu-disabled');
          header && header.classList.add('submenu-open');
        }, OPEN_DELAY);
      };

      const close = () => {
        clearTimeout(openTimer);
        closeTimer = setTimeout(() => {
          li.classList.remove('is-open');
          trigger.setAttribute('aria-expanded','false');
          trigger.classList.remove('submenu-disabled');
          const anyOpen = document.querySelector('.menu > li[data-has-submenu].is-open');
          if (!anyOpen && header) header.classList.remove('submenu-open');
        }, CLOSE_DELAY);
      };

      li.addEventListener('mouseenter', open);
      li.addEventListener('mouseleave', close);

      trigger.addEventListener('focus', open);
      panel.addEventListener('focusin', () => { clearTimeout(closeTimer); });
      panel.addEventListener('focusout', (e) => {
        if (!li.contains(e.relatedTarget)) close();
      });

      trigger.addEventListener('click', (e) => {
        e.preventDefault();
        if (li.classList.contains('is-open')) {
          close();
        } else {
          open();
        }
      });

      panel.addEventListener('mouseenter', () => clearTimeout(closeTimer));
      trigger.addEventListener('mouseenter', () => clearTimeout(closeTimer));
      panel.addEventListener('mouseleave', close);

      li.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          close();
          trigger.focus();
        }
      });
    });

    document.addEventListener('click', (e) => {
      const anyOpen = document.querySelector('.menu > li[data-has-submenu].is-open');
      if (!anyOpen) return;
      if (!anyOpen.contains(e.target)) {
        anyOpen.classList.remove('is-open');
        const trigger = anyOpen.querySelector(':scope > a[aria-haspopup="true"]');
        trigger && trigger.setAttribute('aria-expanded','false');
        trigger && trigger.classList.remove('submenu-disabled');
        const anotherOpen = document.querySelector('.menu > li[data-has-submenu].is-open');
        const header = document.querySelector('header');
        if (!anotherOpen && header) header.classList.remove('submenu-open');
      }
    });
  })();

  (function(){
    const btn = document.querySelector('.menu-toggle');
    const menu = document.getElementById('primary-menu');
    const backdrop = document.querySelector('.menu-backdrop');

    if(!btn || !menu || !backdrop) return;

    function open(){
      btn.classList.add('is-open');
      menu.classList.add('is-open');
      btn.setAttribute('aria-expanded','true');
      backdrop.hidden = false;
    }
    function close(){
      btn.classList.remove('is-open');
      menu.classList.remove('is-open');
      btn.setAttribute('aria-expanded','false');
      backdrop.hidden = true;
    }

    btn.addEventListener('click', () => {
      if(menu.classList.contains('is-open')) close(); else open();
    });
    backdrop.addEventListener('click', close);
  })();

  (function(){
    const y = document.getElementById('year');
    if (y) y.textContent = new Date().getFullYear();
  })();

  /* ====== 🆕 Menú de idioma (hover con retardo suave) ====== */
  (function(){
    const switcher = document.querySelector('.lang-switcher');
    const trigger  = document.querySelector('.lang-trigger');
    const menu     = document.querySelector('.lang-menu');

    if (!switcher || !trigger || !menu) return;

    let closeTimer = null;
    const CLOSE_DELAY = 200; // retrasa el cierre para que no desaparezca al pasar el ratón

    function openMenu(){
      clearTimeout(closeTimer);
      trigger.setAttribute('aria-expanded', 'true');
      menu.style.opacity = '1';
      menu.style.pointerEvents = 'auto';
      menu.style.transform = 'translateY(0)';
    }

    function closeMenu(){
      clearTimeout(closeTimer);
      closeTimer = setTimeout(() => {
        trigger.setAttribute('aria-expanded', 'false');
        menu.style.opacity = '0';
        menu.style.pointerEvents = 'none';
        menu.style.transform = 'translateY(-8px)';
      }, CLOSE_DELAY);
    }

    switcher.addEventListener('mouseenter', openMenu);
    switcher.addEventListener('mouseleave', closeMenu);
    switcher.addEventListener('focusin', openMenu);
    switcher.addEventListener('focusout', (e) => {
      if (!switcher.contains(e.relatedTarget)) closeMenu();
    });

    // Evita clics
    trigger.addEventListener('click', (e) => e.preventDefault());
  })();
  </script>
</body>
</html>
